---
date created: 2023-04-20 21:49
---

#cpp/内存分析

# 内存分析

栈通常是一个预定大小的内存区域，----2mb

堆是可以成长的

工作原理不同的(分配内存的方式不一样)，但是目的一样。

栈中变量都是紧挨着的---见内存---一层层堆上去---因此栈里面运行是很快的

堆里面分配的位置不是连续的

## new做了什么事情

调用malloc---查找free list---分配内存

因为在heap中有更多的cache missing，因此花了更多时间

但是分配是两者之间最大的区别

在栈上面分配内存只有一句话

在堆上面new---找free list---记录拿了多少内存(用于delete)

在堆上面delete---也会有很多操作

因此尽量在栈上分配变量而不是在堆里

使用堆的时机：

- 变量的声明周期比作用域长
- 变量需要的内存很大！！！！
